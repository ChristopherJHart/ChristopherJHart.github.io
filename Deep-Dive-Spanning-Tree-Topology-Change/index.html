<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Deep Dive - IEEE 802.1D Spanning Tree Topology Change" /><meta property="og:locale" content="en" /><meta name="description" content="While reviewing the IEEE 802.1D Spanning Tree Protocol Topology Change Notification mechanism, I felt some confusion as to the exact behavior that each bridge exhibits when a topology change occurs. This post documents my journey to alleviate this confusion in the lab!" /><meta property="og:description" content="While reviewing the IEEE 802.1D Spanning Tree Protocol Topology Change Notification mechanism, I felt some confusion as to the exact behavior that each bridge exhibits when a topology change occurs. This post documents my journey to alleviate this confusion in the lab!" /><link rel="canonical" href="https://www.chrisjhart.com/Deep-Dive-Spanning-Tree-Topology-Change/" /><meta property="og:url" content="https://www.chrisjhart.com/Deep-Dive-Spanning-Tree-Topology-Change/" /><meta property="og:site_name" content="Christopher Hart" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-12-14T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Deep Dive - IEEE 802.1D Spanning Tree Topology Change" /><meta name="twitter:site" content="@_ChrisJHart" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"While reviewing the IEEE 802.1D Spanning Tree Protocol Topology Change Notification mechanism, I felt some confusion as to the exact behavior that each bridge exhibits when a topology change occurs. This post documents my journey to alleviate this confusion in the lab!","url":"https://www.chrisjhart.com/Deep-Dive-Spanning-Tree-Topology-Change/","@type":"BlogPosting","headline":"Deep Dive - IEEE 802.1D Spanning Tree Topology Change","dateModified":"2019-12-14T00:00:00-05:00","datePublished":"2019-12-14T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.chrisjhart.com/Deep-Dive-Spanning-Tree-Topology-Change/"},"@context":"https://schema.org"}</script><title>Deep Dive - IEEE 802.1D Spanning Tree Topology Change | Christopher Hart</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Christopher Hart"><meta name="application-name" content="Christopher Hart"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars3.githubusercontent.com/u/13562529" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Christopher Hart</a></div><div class="site-subtitle font-italic">Documenting my discoveries in the IT world</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ChristopherJHart" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/_ChrisJHart" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['christopherjhart95','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Deep Dive - IEEE 802.1D Spanning Tree Topology Change</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Deep Dive - IEEE 802.1D Spanning Tree Topology Change</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Christopher Hart </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Dec 14, 2019, 12:00 AM -0500" >Dec 14, 2019<i class="unloaded">2019-12-14T00:00:00-05:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3457 words">19 min read</span></div></div><div class="post-content"><p>While reviewing the IEEE 802.1D Spanning Tree Protocol Topology Change Notification mechanism, I felt some confusion as to the exact behavior that each bridge exhibits when a topology change occurs. This post documents my journey to alleviate this confusion in the lab!</p><h2 id="scope">Scope</h2><p>During my CCIE studies, I understood that there were two types of BPDUs - a Configuration BPDU and a Topology Change Notification BPDU. However, I was unclear which bridges create which BPDU in a topology change scenario. Specifically, I wanted to clarify the following points:</p><ol><li><p>When a topology change occurs on a non-root bridge (such as in the event of a link flap), what type of BPDU does that bridge create?</p><li><p>When an intermediate bridge receives a topology change notification from a downstream bridge, what type of BPDU is sent towards the root bridge, and what type of BPDU is sent towards the downstream bridge?</p><li><p>When a topology change occurs in a spanning tree, what type of BPDU do bridges not in the path of the topology change notification receive?</p></ol><p>To answer these questions, I decided to test in the lab!</p><h2 id="topology">Topology</h2><p><img data-proofer-ignore data-src="/images/2019-12-STP-DD-TCN-Topology.png" alt="" /></p><p>Bridge ID and IP address information is as follows:</p><div class="table-wrapper"><table><thead><tr><th>Node Name<th>Bridge ID<th>IP Address<tbody><tr><td>Root<td>5e00.0000.0000<td>192.168.1.1<tr><td>S1-1<td>5e00.0001.0000<td>192.168.1.100<tr><td>S2-1<td>5e00.0002.0000<td>192.168.1.103<tr><td>S1-2<td>5e00.0003.0000<td>192.168.1.101<tr><td>S1-3<td>5e00.0004.0000<td>192.168.1.102<tr><td>S2-2<td>5e00.0005.0000<td>192.168.1.104<tr><td>S2-3<td>5e00.0006.0000<td>192.168.1.105<tr><td>H1-1<td>N/A<td>192.168.1.10<tr><td>H1-2<td>N/A<td>192.168.1.20<tr><td>H2-1<td>N/A<td>192.168.1.30<tr><td>H2-2<td>N/A<td>192.168.1.40</table></div><h2 id="lab-materials">Lab Materials</h2><p>This lab was completed with a VIRL 1.6.65 server using the following nodes:</p><div class="table-wrapper"><table><thead><tr><th>Node Name<th>Operating System<th>Version<tbody><tr><td>IOSv<td>IOS<td>15.7(3)M3<tr><td>IOSvL2<td>IOS<td>15.2</table></div><h2 id="default-configuration">Default Configuration</h2><p>By default, all nodes were configured with their hostname, as well as the following configuration:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>no ip domain-lookup
service timestamps debug datetime msec
service timestamps log datetime msec
logging buffered 10000000

interface GigabitEthernet0/0
  shutdown

line console 0
  exec-timeout 0 0
  logging synchronous
</pre></table></code></div></div><p>After all nodes came online, their clock was manually set to the same time with the <code class="language-plaintext highlighter-rouge">clock set</code> global EXEC command. However, the time of the clocks drifted during the lab, so not all debug or log timestamps are synchronized across devices.</p><h2 id="lab">Lab</h2><p>We will attempt to answer our questions with the above topology through a link flap on S1-2’s Gi0/2 interface towards H1-1 while relevant debugs are running on S1-2, S1-1, Root, and S2-1.</p><p>First, let’s configure the switch named “Root” as the root bridge for VLAN 1. By default, it should already be the root bridge as a result of its bridge ID, but we will manually configure its priority anyway.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>Root#configure terminal
Enter configuration commands, one per line.  End with CNTL/Z.
Root(config)#spanning-tree vlan 1 root primary
Root(config)#end
Root#show spanning-tree vlan 1

VLAN0001
  Spanning tree enabled protocol ieee
  Root ID    Priority    24577
             Address     5e00.0000.0000
             This bridge is the root
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    24577  (priority 24576 sys-id-ext 1)
             Address     5e00.0000.0000
             Hello Time   2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time  300 sec

Interface           Role Sts Cost      Prio.Nbr Type
------------------- ---- --- --------- -------- --------------------------------
Gi0/1               Desg FWD 4         128.2    P2p 
Gi0/2               Desg FWD 4         128.3    P2p 
</pre></table></code></div></div><p>Next, let’s review the debugs we need to enable. On S1-2, Root, and S2-1, we will want to see Spanning Tree topology events as well as BPDUs that are sent and received.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre>Root#debug spanning-tree ?
  all              All Spanning Tree debugging messages
  bpdu             Spanning tree BPDU              &lt;&lt;&lt;
  bpdu-opt         Optimized BPDU handling
  config           Spanning tree config changes    &lt;&lt;&lt;
  etherchannel     EtherChannel support
  events           Spanning tree topology events
  exceptions       Spanning tree exceptions
  general          Spanning tree general
  mstp             MSTP debug commands
  pvst+            PVST+ events
  root             Spanning tree root events
  snmp             Spanning Tree SNMP handling
  switch           Switch Shim debug commands
  synchronization  STP state sync events

Root#debug spanning-tree events
Spanning Tree event debugging is on
Root#debug spanning-tree bpdu
Root#

S1-1#debug spanning-tree events
Spanning Tree event debugging is on
S1-1#debug spanning-tree bpdu
S1-1#

S1-2#debug spanning-tree events
Spanning Tree event debugging is on
S1-2#debug spanning-tree bpdu  
S1-2#

S2-1#debug spanning-tree events
Spanning Tree event debugging is on
S2-1#debug spanning-tree bpdu  
S2-1#
</pre></table></code></div></div><p>Now, let’s shut down S1-2’s Gi0/2, causing a topology change.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>S1-2#configure terminal
S1-2(config)#interface GigabitEthernet0/2
S1-2(config-if)#shutdown
S1-2(config-if)#end
</pre></table></code></div></div><p>After waiting for the topology to stabilize, let’s shut off the debugs on each device.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Root#undebug all
All possible debugging has been turned off

S1-1#undebug all
All possible debugging has been turned off

S1-2#undebug all
All possible debugging has been turned off

S2-1#undebug all
All possible debugging has been turned off
</pre></table></code></div></div><p>Now, let’s review the debugs sent to S1-2’s logfile. Note that the “Dec.14.14:38:27” regular expression only shows us debugs that occurred immediately after the Gi0/2 interface was shutdown.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>S1-2#show logging | begin Dec.14.14:38:27  
&lt;snip&gt;
1 | Dec 14 14:38:27.613: STP: VLAN0001 rx BPDU: config protocol = ieee, packet from GigabitEthernet0/1  , linktype IEEE_SPANNING , enctype 2, encsize 17    &lt;&lt;&lt;-|
2 | Dec 14 14:38:27.614: STP: enc 01 80 C2 00 00 00 FA 16 3E D2 06 2C 00 26 42 42 03                                                                        &lt;&lt;&lt; |
3 | Dec 14 14:38:27.621: STP: Data     000000000060015E00000000000000000480015E000001000080030100140002000F00                                               &lt;&lt;&lt; |- 1.
4 | Dec 14 14:38:27.634: STP: VLAN0001 Gi0/1:0000 00 00 00 60015E0000000000 00000004 80015E0000010000 8003 0100 1400 0200 0F00                              &lt;&lt;&lt; |
5 | Dec 14 14:38:27.648: STP(1) port Gi0/1 supersedes 0                                                                                                     &lt;&lt;&lt;-|

1 | Dec 14 14:38:27.649: STP: VLAN0001 Gi0/2 tx BPDU: config protocol=ieee                                                                                  &lt;&lt;&lt;-|- 2.
2 |     Data : 0000 00 00 00 60015E0000000000 00000008 80015E0000030000 8003 0200 1400 0200 0F00                                                            &lt;&lt;&lt;-|

1 | Dec 14 14:38:28.683: STP: VLAN0001 Gi0/1 tx BPDU: tcn: 0000 00 80                                                                                       &lt;&lt;&lt;-|- 3.

1 | Dec 14 14:38:28.685: STP: VLAN0001 sent Topology Change Notice on Gi0/1                                                                                 &lt;&lt;&lt;-|- 4.
2 | Dec 14 14:38:28.685: STP[1]: Generating TC trap for port GigabitEthernet0/2                                                                             &lt;&lt;&lt;-|
</pre></table></code></div></div><p>The debugs show that four separate events occurred on S1-2. I visually segregated these events to make it easier to visualize. To the right of each debug is each logical event. To the left of each debug is an individual line number that I will refer to for more detail.</p><p>The four events are:</p><ol><li><p>S1-2 receives a Configuration BPDU on Gi0/1 originated by the root bridge (Root) and passed on by S1-1. This makes sense, as Gi0/1 is our root port. The debug in line 4 shows us the contents of this Configuration BPDU and logically separates it into each section of the BPDU to make it easier to read (unlike line 3, which lumps everything together). The fourth section in line 4 is the “BPDU Flags” section, which is a 2-byte field containing the Topology Change Acknowledgment flag and the Topology Change flag. Since both of these values are set to zero, this tells us that this Configuration BPDU was originated <em>before</em> the topology change (that is, the flapping of Gi0/2) occurred. As such, for our purposes, we can ignore it.</p><li><p>S1-2 generates a Configuration BPDU on Gi0/2 (the interface that was <em>just</em> administratively shut down). At first, this might not make sense (after all, why would Spanning Tree attempt to send a Configuration BPDU out of an interface that is down?) However, since the Spanning Tree process on S1-2 has not yet sent a Topology Change Notification BPDU towards the root bridge, the Spanning Tree process is most likely not yet aware that the Gi0/2 interface is down at the moment. As a result, Spanning Tree would likely hand the Configuration BPDU generated in this debug to the data plane, which would subsequently drop it since it cannot forward a frame out of an interface that is down.</p><li><p>About a second later, S1-2 generates a Topology Change Notification BPDU out of Gi0/1. This indicates that the Spanning Tree process is now aware that Gi0/2 is down, and that a topology change has occurred. Just like the debug on the fourth line of the first event, this debug logically separates each part of the BPDU to make it easier to read. In this debug, the third section is set to <code class="language-plaintext highlighter-rouge">0x80</code>. This indicates that this is a Topology Change Notification BPDU. This stands in contrast to the <code class="language-plaintext highlighter-rouge">0x00</code> value seen in line four of the first event, which indicates the BPDU is a Configuration BPDU.</p><li><p>Finally, the Spanning Tree process reports that it has sent a Topology Change Notification (in this case, the debug calls it a “Notice”) out of the root port, Gi0/1.</p></ol><p>The screenshot below shows the exact Topology Change Notification BPDU generated by S1-2 that is sent out of the Gi0/1 interface from a Wireshark perspective.</p><p><img data-proofer-ignore data-src="/images/2019-12-STP-DD-TCN-BPDU.png" alt="" /></p><p>Next, we must search through S1-1’s debugs to find when it receives this Topology Change Notification BPDU, as well as what it does with it.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>S1-1#show logging | begin Dec.14.14:38
&lt;snip&gt;
1 | Dec 14 14:38:12.185: STP: VLAN0001 rx BPDU: config protocol = ieee, packet from GigabitEthernet0/2  , linktype IEEE_SPANNING , enctype 2, encsize 17    &lt;&lt;&lt;-|
2 | Dec 14 14:38:12.187: STP: enc 01 80 C2 00 00 00 FA 16 3E E8 6D CD 00 07 42 42 03                                                                        &lt;&lt;&lt; |
3 | Dec 14 14:38:12.193: STP: Data     00000080                                                                                                             &lt;&lt;&lt; |- 1.
4 | Dec 14 14:38:12.194: STP: VLAN0001 Gi0/2:0000 00 80                                                                                                     &lt;&lt;&lt; |
5 | Dec 14 14:38:12.196: STP: VLAN0001 Topology Change rcvd on Gi0/2                                                                                        &lt;&lt;&lt;-|

1 | Dec 14 14:38:12.198: STP: VLAN0001 Gi0/1 tx BPDU: tcn: 0000 00 80                                                                                       &lt;&lt;&lt;-|- 2.
2 | Dec 14 14:38:12.200: STP: VLAN0001 sent Topology Change Notice on Gi0/1                                                                                 &lt;&lt;&lt;-|

1 | Dec 14 14:38:12.201: STP: VLAN0001 Gi0/2 tx BPDU: config protocol=ieee                                                                                  &lt;&lt;&lt;-|- 3.
2 |     Data : 0000 00 00 80 60015E0000000000 00000004 80015E0000010000 8003 0200 1400 0200 0F00                                                            &lt;&lt;&lt;-|
</pre></table></code></div></div><p>These debugs show three separate events that occurred on S1-1:</p><ol><li><p>S1-1 receives the Topology Change Notification BPDU from Gi0/2, as shown by line 1. You can tell that this is the Topology Change Notification BPDU sent by S1-2 because of the <code class="language-plaintext highlighter-rouge">0x80</code> value in the third field of the BPDU shown in line 4. S1-1 recognizes this as a Topology Change Notification BPDU and logs it as such in line 5.</p><li><p>Before doing anything else, S1-1 creates a new Topology Change Notification BPDU and sends it out of Gi0/1 (the bridge’s root port) towards Root. Line 1 shows the contents of this BPDU.</p><li><p>Finally, S1-1 sends a Configuration BPDU out of Gi0/2 towards S1-2 with a value of <code class="language-plaintext highlighter-rouge">0x80</code> in the fourth field, as shown by line 2. If you convert <code class="language-plaintext highlighter-rouge">0x80</code> to binary, you get <code class="language-plaintext highlighter-rouge">1000 0000</code>. The most significant bit of the BPDU Flags field is the “Topology Change Acknowledgment” bit. As such, this Configuration BPDU is informing the downstream bridge (S1-2) that the Topology Change Notification BPDU has been received. If S1-2 did <em>not</em> receive this BPDU, S1-2 would continue sending Topology Change Notification BPDUs at the expiration of each Hello timer (that is, every 2 seconds by default).</p></ol><p>Take a second to think about why S1-1 chooses to send a Topology Change Notification BPDU to the root bridge <em>before</em> sending an acknowledgment to S1-2 that S1-2’s Topology Change Notification BPDU was received. From a protocol philosophy perspective, this makes perfect sense. If you were designing a hierarchical protocol that needs to rapidly react to a topology change, and you made the decision that the head of the hierarchy (in this case, the root bridge) is responsible for propagating information about the topology change, you would want hierarchy members (bridges) to inform the hierarchy head (root bridge) about the change as rapidly as possible so that the <em>rest</em> of the hierarchy can react to the topology change. Therefore, when an intermediate bridge receives the news that a topology change has occurred from a downstream bridge, the bridge should prioritize passing along the news towards the root bridge over acknowledging receipt of the news.</p><p>The screenshot below shows the Configuration BPDU with the “Topology Change Acknowledgment” flag set that is sent from S1-1 to S1-2 from a Wireshark perspective.</p><p><img data-proofer-ignore data-src="/images/2019-12-STP-DD-Cfg-BPDU-TCA.png" alt="" /></p><p>Now, let’s review Root’s debugs to find when it receives the Topology Change Notification BPDU originated by S1-1.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>Root#show logging | begin Dec.14.14:38
&lt;snip&gt;
1 | Dec 14 14:38:34.702: STP: VLAN0001 rx BPDU: config protocol = ieee, packet from GigabitEthernet0/1  , linktype IEEE_SPANNING , enctype 2, encsize 17    &lt;&lt;&lt;-|
2 | Dec 14 14:38:34.703: STP: enc 01 80 C2 00 00 00 FA 16 3E DD 98 A1 00 07 42 42 03                                                                        &lt;&lt;&lt; |- 1.
3 | Dec 14 14:38:34.711: STP: VLAN0001 Gi0/1:0000 00 80                                                                                                     &lt;&lt;&lt; |
4 | Dec 14 14:38:34.713: STP: VLAN0001 Topology Change rcvd on Gi0/1                                                                                        &lt;&lt;&lt;-|

1 | Dec 14 14:38:34.715: STP: VLAN0001 Gi0/1 tx BPDU: config protocol=ieee                                                                                  &lt;&lt;&lt;-|- 2.
2 |     Data : 0000 00 00 81 60015E0000000000 00000000 60015E0000000000 8002 0000 1400 0200 0F00                                                            &lt;&lt;&lt;-|

1 | Dec 14 14:38:35.622: STP: VLAN0001 Gi0/2 tx BPDU: config protocol=ieee                                                                                  &lt;&lt;&lt;-|- 3.
2 |     Data : 0000 00 00 01 60015E0000000000 00000000 60015E0000000000 8003 0000 1400 0200 0F00                                                            &lt;&lt;&lt;-|
</pre></table></code></div></div><p>These debugs show three separate events that occurred on Root:</p><ol><li><p>Root receives the Topology Change Notification BPDU from Gi0/1, as shown by line 1. You can tell that this is the Topology Change Notification BPDU sent by S1-1 because of the <code class="language-plaintext highlighter-rouge">0x80</code> value in the third field of the BPDU shown in line 3. Root recognizes this as a Topology Change Notification BPDU and logs it as such in line 4.</p><li><p>Root sends a Configuration BPDU out of Gi0/1 with the Topology Change Acknowledgment and Topology Change bits set in the BPDU Flags field. As shown in line 2, the fourth section of the BPDU has a value of <code class="language-plaintext highlighter-rouge">0x81</code>. If you convert <code class="language-plaintext highlighter-rouge">0x81</code> to binary, you get <code class="language-plaintext highlighter-rouge">1000 0001</code>. The most significant bit of the BPDU Flags field is the “Topology Change Acknowledgment” bit, while the least significant bit of the BPDU Flags field is the “Topology Change” bit. Root is sending a Configuration BPDU to S1-2 acknowledging that it received S1-2’s Topology Change Notification BPDU, as well as informing it that there was a change in the topology of the spanning tree.</p><li><p>Root sends a Configuration BPDU out of Gi0/2 with the Topology Change bit set in the BPDU Flags field. As shown in line 2, the fourth section of the BPDU has a value of <code class="language-plaintext highlighter-rouge">0x01</code>. If you convert <code class="language-plaintext highlighter-rouge">0x01</code> to binary, you get <code class="language-plaintext highlighter-rouge">0000 0001</code>. The least significant bit of the BPDU Flags field is the “Topology Change” bit. Root is sending a Configuration BPDU towards S2-1 stating that there was a change in the topology of this spanning tree.</p></ol><p>The screenshot below shows the Configuration BPDU with the “Topology Change Acknowledgment” and “Topology Change” bits set sent from Root to S1-1 from a Wireshark perspective.</p><p><img data-proofer-ignore data-src="/images/2019-12-STP-DD-Cfg-BPDU-TC-TCA.png" alt="" /></p><p>If we take a look at S1-1 once more, we see debugs with three different events. The first event indicates that S1-1 received the Configuration BPDU from Root on Gi0/1 with the “Topology Change Acknowledgment” and “Topology Change” bits set. The second and third events indicate that S1-1 sends Configuration BPDUs out of Gi0/2 (towards S1-2) and Gi0/3 (towards S1-3) with the “Topology Change” bit set.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>1 | Dec 14 14:38:12.215: STP: VLAN0001 rx BPDU: config protocol = ieee, packet from GigabitEthernet0/1  , linktype IEEE_SPANNING , enctype 2, encsize 17    &lt;&lt;&lt;-|
2 | Dec 14 14:38:12.216: STP: enc 01 80 C2 00 00 00 FA 16 3E C3 32 11 00 26 42 42 03                                                                        &lt;&lt;&lt; |
3 | Dec 14 14:38:12.222: STP: Data     000000008160015E00000000000000000060015E000000000080020000140002000F00                                               &lt;&lt;&lt; |- 1.
4 | Dec 14 14:38:12.231: STP: VLAN0001 Gi0/1:0000 00 00 81 60015E0000000000 00000000 60015E0000000000 8002 0000 1400 0200 0F00                              &lt;&lt;&lt; |
5 | Dec 14 14:38:12.240: STP(1) port Gi0/1 supersedes 0                                                                                                     &lt;&lt;&lt;-|

1 | Dec 14 14:38:12.242: STP: VLAN0001 Gi0/3 tx BPDU: config protocol=ieee                                                                                  &lt;&lt;&lt;-|- 2.
2 |     Data : 0000 00 00 01 60015E0000000000 00000004 80015E0000010000 8004 0100 1400 0200 0F00                                                            &lt;&lt;&lt;-|

1 | Dec 14 14:38:13.219: STP: VLAN0001 Gi0/2 tx BPDU: config protocol=ieee                                                                                  &lt;&lt;&lt;-|- 3.
2 |     Data : 0000 00 00 01 60015E0000000000 00000004 80015E0000010000 8003 0100 1400 0200 0F00                                                            &lt;&lt;&lt;-|
</pre></table></code></div></div><p>Debugs from S2-1 indicate that S2-1 also receives a Configuration BPDU from Root - however, only the “Topology Change” bit is set.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>S2-1#show logging | beg Dec.14.14:38:28
&lt;snip&gt;
1 | Dec 14 14:38:28.547: STP: VLAN0001 rx BPDU: config protocol = ieee, packet from GigabitEthernet0/1  , linktype IEEE_SPANNING , enctype 2, encsize 17    &lt;&lt;&lt;-|
2 | Dec 14 14:38:28.548: STP: enc 01 80 C2 00 00 00 FA 16 3E 12 11 90 00 26 42 42 03                                                                        &lt;&lt;&lt; |
3 | Dec 14 14:38:28.555: STP: Data     000000000160015E00000000000000000060015E000000000080030000140002000F00                                               &lt;&lt;&lt; |- 1.
4 | Dec 14 14:38:28.567: STP: VLAN0001 Gi0/1:0000 00 00 01 60015E0000000000 00000000 60015E0000000000 8003 0000 1400 0200 0F00                              &lt;&lt;&lt; |
5 | Dec 14 14:38:28.579: STP(1) port Gi0/1 supersedes 0                                                                                                     &lt;&lt;&lt;-|

1 | Dec 14 14:38:28.581: STP: VLAN0001 Gi0/2 tx BPDU: config protocol=ieee                                                                                  &lt;&lt;&lt;-|- 2.
2 |     Data : 0000 00 00 01 60015E0000000000 00000004 80015E0000020000 8003 0100 1400 0200 0F00                                                            &lt;&lt;&lt;-|

1 | Dec 14 14:38:28.592: STP: VLAN0001 Gi0/3 tx BPDU: config protocol=ieee                                                                                  &lt;&lt;&lt;-|- 3.
2 |     Data : 0000 00 00 01 60015E0000000000 00000004 80015E0000020000 8004 0100 1400 0200 0F00                                                            &lt;&lt;&lt;-|
</pre></table></code></div></div><p>The screenshot below shows the Configuration BPDU with only the “Topology Change” bit set sent from Root to S2-1 from a Wireshark perspective.</p><p><img data-proofer-ignore data-src="/images/2019-12-STP-DD-Cfg-BPDU-TC.png" alt="" /></p><p>Let’s turn back to Root’s debugs to confirm how long Root will send Configuration BPDUs with the “Topology Change” bit set. The previous debugs from Root show that the first Configuration BPDUs were sent at 14:38:34.715. The below debugs show that the last debug with the “Topology Change” bit set is sent at 14:39:08.120. This shows that Root indicated a topology change was underway for about 34 seconds. This roughly equates to the sum of the Maximum Age timer (20 seconds) and the Forwarding Delay timer (15 seconds), which is expected behavior as documented in <a href="https://www.cisco.com/c/en/us/support/docs/lan-switching/spanning-tree-protocol/12013-17.html#anc8">Cisco’s “Understanding Spanning-Tree Protocol Topology Changes” Troubleshooting TechNote</a>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>Dec 14 14:39:08.105: STP: VLAN0001 Gi0/1 tx BPDU: config protocol=ieee
    Data : 0000 00 00 01 60015E0000000000 00000000 60015E0000000000 8002 0000 1400 0200 0F00
Dec 14 14:39:08.120: STP: VLAN0001 Gi0/2 tx BPDU: config protocol=ieee
    Data : 0000 00 00 01 60015E0000000000 00000000 60015E0000000000 8003 0000 1400 0200 0F00

Dec 14 14:39:10.135: STP: VLAN0001 Gi0/1 tx BPDU: config protocol=ieee
    Data : 0000 00 00 00 60015E0000000000 00000000 60015E0000000000 8002 0000 1400 0200 0F00
Dec 14 14:39:10.151: STP: VLAN0001 Gi0/2 tx BPDU: config protocol=ieee
    Data : 0000 00 00 00 60015E0000000000 00000000 60015E0000000000 8003 0000 1400 0200 0F00
</pre></table></code></div></div><h2 id="conclusion">Conclusion</h2><p>In summary, we were able to determine the answers to our questions by invoking a topology change in an environment with debugs enabled. The answers to our questions are as follows:</p><ol><li><p>When a topology change occurs on a non-root bridge, that bridge will create a Topology Change Notification BPDU and sent it out of the bridge’s Root Port towards the root bridge.</p><li><p>When an intermediate non-root bridge receives a Topology Change Notification BPDU from a downstream bridge, the intermediate bridge will relay the Topology Change Notification BPDU out of its respect Root Port to expedite the topology change process as a whole. Once that task is complete, the intermediate bridge will send a Configuration BPDU towards the downstream bridge that originated the Topology Change Notification BPDU with the “Topology Change Acknowledgment” bit sent to prevent further Topology Change Notification BPDUs from being created.</p><li><p>Bridges that are not in the path of the Topology Change Notification BPDU will eventually receive a Configuration BPDU originated by the root bridge with the “Topology Change” bit set. Upon receiving this BPDU, the bridge will rapidly age out MAC addresses by setting the age of each MAC address to the Forwarding Delay timer (15 seconds).</p></ol><h2 id="references">References</h2><ul><li><a href="https://www.cisco.com/c/en/us/support/docs/lan-switching/spanning-tree-protocol/12013-17.html">“Understanding Spanning-Tree Protocol Topology Changes” Troubleshooting TechNote</a><li>Chapter 3 (“Spanning Tree Protocol”) of the <a href="https://www.amazon.com/Routing-Switching-Official-Guide-Library/dp/1587144921">CCIE Routing and Switching v5.0 Official Cert Guide, Volume 1, Fifth Edition</a><li>“Configuring STP” chapter of the <a href="https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst3750/software/release/15-0_2_se/configuration/guide/scg3750/swstp.html#Understanding%20Basic%20Spanning%20Tree%20Features">Catalyst 3750 Switch Software Configuration Guide, Cisco IOS Release 16.0(2)SE and Later</a></ul><p>I hope that this helps you understand the IEEE 802.1D Spanning Tree Protocol topology change mechanism slightly better!</p></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Deep Dive - IEEE 802.1D Spanning Tree Topology Change - Christopher Hart&url=https://www.chrisjhart.com/Deep-Dive-Spanning-Tree-Topology-Change/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Deep Dive - IEEE 802.1D Spanning Tree Topology Change - Christopher Hart&u=https://www.chrisjhart.com/Deep-Dive-Spanning-Tree-Topology-Change/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Deep Dive - IEEE 802.1D Spanning Tree Topology Change - Christopher Hart&url=https://www.chrisjhart.com/Deep-Dive-Spanning-Tree-Topology-Change/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Windows-10-ssh-copy-id/">Windows 10 OpenSSH Equivalent of ssh-copy-id</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/How-Data-Plane-Traffic-Can-Become-Control-Plane-Traffic/"><div class="card-body"> <span class="timeago small" >Nov 21<i class="unloaded">2021-11-21T00:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ICMP Redirects - How Data Plane Traffic Can Become Control Plane Traffic</h3><div class="text-muted small"><p> Note: If you are not familiar with the concepts of the data plane and control plane on network devices, I highly recommend reviewing my Understanding the Data, Control, and Management Planes of ...</p></div></div></a></div><div class="card"> <a href="/Understanding-Control-Plane-Packet-Loss-due-to-CoPP/"><div class="card-body"> <span class="timeago small" >Nov 13<i class="unloaded">2021-11-13T00:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Understanding Control Plane Packet Loss due to CoPP</h3><div class="text-muted small"><p> Note: If you are not familiar with the concepts of the data plane and control plane on network devices, I highly recommend reviewing my Understanding the Data, Control, and Management Planes of ...</p></div></div></a></div><div class="card"> <a href="/Understanding-Data-Control-Management-Planes/"><div class="card-body"> <span class="timeago small" >Nov 12<i class="unloaded">2021-11-12T00:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Understanding the Data, Control, and Management Planes of Network Devices</h3><div class="text-muted small"><p> While troubleshooting connectivity issues and packet loss in computer networks, network engineers often misunderstand the difference between the data plane and control plane. This can lead to fault...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Quick-Mystery-Spanning-Tree-Priority/" class="btn btn-outline-primary" prompt="Older"><p>Quick Mystery - Spanning Tree Priority</p></a> <a href="/Quick-Lab-RIPv2-Auto-Summary/" class="btn btn-outline-primary" prompt="Newer"><p>Quick Lab - RIPv2 Auto Summary</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/_ChrisJHart">Christopher Hart</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>
